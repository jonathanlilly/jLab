<html><head><meta http-equiv="Content-Style-Type" content="text/html; charset=UTF-8" />
<style type="text/css" media="all"> @import "m2html.css";</style>
<title>jLab Help Files</title></head><body>
<div><h1>PM_WEIGHT is the <a href="jMap.html">jMap</a> module of <a href="jLab.html">jLab</a>.</h1></div><div class="fragment"><pre class="comment">
 <a href="pm_weight.html">PM_WEIGHT</a>  Weighting function for local polynomial fitting. 
 
    <a href="pm_weight.html">PM_WEIGHT</a> computes the weighting function and various related 
    quantities used in local polynomial fitting.  
 
    <a href="pm_weight.html">PM_WEIGHT</a> is called internally by <a href="polymap.html">POLYMAP</a>.  However, for large problems
    it may be preferable to call it externally, as documented in <a href="polymap.html">POLYMAP</a>.
    _________________________________________________________________
 
    [INDEX,AMAT,XMAT,WMAT]=...
                         <a href="pm_weight.html">PM_WEIGHT</a>(DS,XS,YS,INDEXS,[],[],{P,H,ALPHA,BETA}), 
 
    where DS, XS, YS and INDEXS are output by <a href="pm_sort.html">PM_SORT</a>, returns quantities
    needed for a Pth order fit using the kernel specified by ALPHA and BETA.
 
    The kernel is a beta kernel of the form KAPPA*(1-(DS/H)^ALPHA)^BETA, 
    where KAPPA is a normalization coefficient depending on ALPHA and BETA.
 
    DS, XS, YS, and INDEXS describe the sorted distribution of data points 
    relative to an L x M grid.  These are length L cell arrays, with each 
    cell containing M columns and a variable number of rows, denoted NO_l,
    that depends on the L index.  
 
    Note that H, ALPHA, and BETA may all either be scalars or L x M
    matrices.  The fit order P must be a scalar. 
 
    The solution to the least squares problem in local polynomial fitting
    is of the form
  
          BETAHAT = (X^T W X)^(-1) X^T W Z  
 
    where X and W are matrices defined shortly and Z is an N x 1 array 
    of observations.  BETAHAT is a vector of the estimated field together
    with its first P derivatives.  BETAHAT is Q x 1, where Q = 1, 3, and 6
    for P = 0, 1, and 2, respectively. 
 
    Here X is an N x Q matrix of powers of coordinate deviations arising 
    from a Pth order Taylor expansion and W is an N x N matrix of weights. 
    For convenience we define Q X N matrix A as A = (X^T W X)^(-1) * X^T W, 
    such that can write simply write BETAHAT = A Z.
 
    The output of <a href="pm_weight.html">PM_WEIGHT</a> are each length L cell arrays of numerical
    arrays, the lth element of which has the size
 
        INDEX --- N_l x M
         AMAT ---  Q  x N_l x M
         WMAT ---  1  x N_l x M
         XMAT --- N_l x  Q  x M
 
    where N_l is less that or equal to the original size NO_L.  This 
    dimension is reduced from the original such that any points further
    away than the bandwidth H are excluded.
 
    INDEX is a truncated version of INDEXS, while AMAT, WMAT, and XMAT 
    contain respectively the A, W, and X matrices for each cell. 
    __________________________________________________________________
 
    Weighted data points
 
    <a href="pm_weight.html">PM_WEIGHT</a>(DS,XS,YS,[],WS,{P,H,ALPHA,BETA}) also applies the additional
    nonnegative weights WS to the data points.  
    
    This is useful in at least three circumstances: (i) weighting data 
    points according to their estimated significance, (ii) weighting as a 
    part of an iterative robustification scheme, or (iii) weighting
    aggregated data points according to the number of observations 
    represented, as a way of downscaling large numbers of observations.  
    __________________________________________________________________
 
    Temporal fit
 
    <a href="pm_weight.html">PM_WEIGHT</a>(DS,XS,YS,TS,[],{P,H,ALPHA,BETA},{MU,TAU,ALPHAT,BETAT}) and
    <a href="pm_weight.html">PM_WEIGHT</a>(DS,XS,YS,TS,WS,{P,H,ALPHA,BETA},{MU,TAU,ALPHAT,BETAT}) also
    incorporates an order MU fit in the time domain.  MU may be 1 or 2.
  
    Here TS represents the times of the observations, in the same units as
    the temporal bandwidth TAU, with the center of the weighting function 
    corresponding to time zero.  
 
    ALPHAT and BETAT describe the properties of the temporal kernel. 
 
    In output array sizes, Q is replaced with QTILDE=Q+MU.
    __________________________________________________________________
 
    Additional output arguments
 
    [AMAT,XMAT,WMAT,H,C]=<a href="pm_weight.html">PM_WEIGHT</a>(...) also outputs two L x M matrices.
 
    H is the matrix of bandwidths used to construct the weighting function.
    This may differ from the H that is input when the minimum population
    is specified, or when the 'population' flag is input; see below.
 
    C contains the condition number of the inverted Q x Q matrix [X^T W X] 
    at each grid point, a potentially useful diagnostic.
    __________________________________________________________________
 
    Other options
 
    <a href="pm_weight.html">PM_WEIGHT</a> supports a number of other options, as documented more 
    completely in <a href="polymap.html">POLYMAP</a>.
 
    <a href="pm_weight.html">PM_WEIGHT</a>(...,'minpop',NMIN) uses NMIN for the minimum population.
 
    <a href="pm_weight.html">PM_WEIGHT</a>(...,{P,HO,ALPHA,BETA},...,'population',N) specifies a fixed
    population fit with population N and maximum bandwidth HO.  N can be a
    scalar or an L x M matrix.
  
    <a href="pm_weight.html">PM_WEIGHT</a>(...,'verbose') displays the row it is currently working on.
 
    <a href="pm_weight.html">PM_WEIGHT</a>(...,'parallel') parallelizes the computation using PARFOR.
 
    <a href="pm_weight.html">PM_WEIGHT</a>(...'parallel',Nworkers) parallelizes the computation with a
    specified number of workers.
    __________________________________________________________________
 
    See also <a href="polymap.html">POLYMAP</a>, <a href="pm_sort.html">PM_SORT</a>, and <a href="pm_apply.html">PM_APPLY</a>.
 
   '<a href="pm_weight.html">pm_weight</a> --t' runs a test.
 
    Usage: [index,amat,xmat,wmat,H,C]=...
                                <a href="pm_weight.html">pm_weight</a>(ds,xs,ys,indexs,[],[],{P,H,2,1});
           [index,amat,xmat,wmat,H,C]=...
                                <a href="pm_weight.html">pm_weight</a>(ds,xs,ys,indexs,ts,ws,{P,H,2,1});
    __________________________________________________________________
    This is part of <a href="jLab.html">JLAB</a> --- type 'help jlab' for more information
    (C) 2022 J.M. Lilly --- type 'help <a href="jlab_license.html">jlab_license</a>' for details
</pre></div><h2><a href="jLab.html">contents</a>  |  <a href="jlab_allhelp.html">allhelp</a>  |  <a href="jlab_index.html">index</a></h2></body></html>