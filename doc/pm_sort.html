<html><head><meta http-equiv="Content-Style-Type" content="text/html; charset=UTF-8" />
<style type="text/css" media="all"> @import "m2html.css";</style>
<title>jLab Help Files</title></head><body>
<div><h1>PM_SORT is the <a href="jMap.html">jMap</a> module of <a href="jLab.html">jLab</a>.</h1></div><div class="fragment"><pre class="comment">
 <a href="pm_sort.html">PM_SORT</a>  Sort data points according to distance from grid points in 2D.
 
    Given data points distributed in two dimensions along with a grid, 
    <a href="pm_sort.html">PM_SORT</a> returns the data points sorted by increasing distance from each
    grid point, up to some specified maximum.  This works both for 
    Cartesian geometry as well as on the surface of Earth. 
 
    <a href="pm_sort.html">PM_SORT</a> is called internally by <a href="polymap.html">POLYMAP</a>.  However, for large problems
    it may be preferable to call it externally, as documented in <a href="polymap.html">POLYMAP</a>.
    _________________________________________________________________
    
    Sorting on the plane
 
    [DS,XS,YS]=<a href="pm_sort.html">PM_SORT</a>(X,Y,XO,YO,CUTOFF) returns sorted distances D between
    data points at locations X,Y and grid points at XO,YO.
 
    X and Y are arrays of the same size into data point locations. Any non-
    finite values in X and Y are ignored.
  
    XO and YO are arrays of length M and L, say, specifying the bin center
    locations of an L x M matrix of grid points, i.e.
 
       XO= [XO_1 XO_2 ... XO_M]      YO =  [YO_1;    
                                            YO_2; 
                                             ...
                                            YO_L]
 
    CUTOFF is the maximum distance to be included in the output arrays.
 
    The output arrays are L numerical arrays arranged as a length L cell
    array.  That is, there is one cell per element of YO. Each numerical 
    array has M columns, i.e., the number of elements of XO, with the 
    number of rows varying between arrays.  This organization was chosen to
    in order to optimize memory usage and facilitate paralellization.
 
    DS gives the distances SQRT((X-XO)^2+(Y-YO)^2) of all data points less
    than the CUTOFF distance from the (l,m)th grid point, sorted in order
    of increasing distance.  Entries farther than CUTOFF in all output
    fields are filled with NaNs.
 
    XS and YS are corresponding deviations X-XO and Y-YO from the grid 
    point location to each data point.
    _________________________________________________________________
  
    Limiting output dimension
 
    [DS,XS,YS]=<a href="pm_sort.html">PM_SORT</a>(X,Y,XO,YO,[CUTOFF NMAX]), where the fifth input 
    argument is a 2-vector, additionally specifies that number of rows of
    in each cell of the output will be no larger than NMAX.  This option is
    useful for the 'fixed population' algorithm in <a href="polymap.html">POLYMAP</a>.
    _________________________________________________________________
  
    Additional input parameters
 
    Let's say some additional variables Z1, Z2,...,ZK are given at the data
    locations X,Y.  Then 
    
    [DS,XS,YS,Z1S,Z2S,...,ZKS]=
 
                 <a href="pm_sort.html">PM_SORT</a>(X,Y,Z1,Z2,...,ZK,XO,YO,CUTOFF);
 
    also returns the values of these variables.
 
    Z1S, Z2S,...,ZKS are the same size as the other output arguments, and 
    give the values of Z1, Z2,...,ZK sorted according to distance.
    _________________________________________________________________
  
    Outputting an index
 
    [DS,XS,YS,INDEXS]=<a href="pm_sort.html">PM_SORT</a>(X,Y,XO,YO,CUTOFF), with no additional input 
    arguments, returns a cell array of indices, INDEXS, which is the same 
    size as the other output fields.  This can be used together with 
    <a href="pm_index.html">PM_INDEX</a> to find sorted field values.  
 
    If there are many fields to be mapped all using the same grid, this
    approach is preferred to directly inputing Z1, Z2, ..., ZK as in the 
    described previously. Instead the ZK would be output on as as-needed 
    basis by <a href="pm_index.html">PM_INDEX</a>.
 
    For usage details, see the "One grid, many fields" section in <a href="polymap.html">POLYMAP</a>. 
    _________________________________________________________________
    
    Sorting on the surface of the Earth
 
    <a href="pm_sort.html">PM_SORT</a> can also handle data points distributed on the Earth's surface.
 
    [DS,XS,YS]=<a href="pm_sort.html">PM_SORT</a>(LON,LAT,LONO,LATO,CUTOFF,'sphere') returns the great
    circle distances DS between data points at locations LON, LAT and
    nearby grid points located at LONO, LATO, sorted in order of distance. 
    Longitude LON and latitude LAT are given in degrees.
 
    XS and YS are the corresponding x- and y-coordinates, in kilometers, of
    the sorted data points in a local tangent plane about each grid point. 
  
    The maximum value of CUTOFF is <a href="radearth.html">RADEARTH</a> * PI/2, or a quarter of the 
    circumference of the Earth, so that sorted (LAT,LON) points will 
    necessarily lie in the same hemisphere as the grid points.  Larger 
    values of CUTOFF will be set to this value.
 
    As with sorting on the plane, given LATO of length L and LONO of length 
    M, the output fields will again be L numerical arrays arranged as 
    length L cell arrays, with each numerical array having M columns. 
 
    <a href="pm_sort.html">PM_SORT</a> uses lat/lon truncation criteria to exclude points that cannot 
    be nearer than CUTOFF, avoiding unnecessary computations involving the 
    great circle distance and considerably speeding up the sorting.
 
    Note that since the number of points less than CUTOFF distance tends to 
    vary strongly with latitude, the use of 3D arrays for the sorted fields 
    would lead to large arrays with many NaNs.  The choice to put latitude
    bands into cell arrays avoids this and thus uses less system memory. 
 
    Note that all of the above options also work with the 'sphere' flag.
    _________________________________________________________________
    
    Masking out regions on the Earth
 
    When the 'sphere' flag is input, <a href="pm_sort.html">PM_SORT</a>(...,'mask',BOOL,...), with
    BOOL being an L x M matrix, will returns output fields only at points 
    for which BOOL is true.  Where BOOL is false, the output arrays will 
    consist of all NaNs.
 
    This is useful in preventing <a href="pm_sort.html">PM_SORT</a> from sorting data for locations
    one has no intention of mapping.  For example, in creating a map of an
    oceanic quantity, BOOL would be set to false for all land grid points.
    _________________________________________________________________
   
    Other options
 
    <a href="pm_sort.html">PM_SORT</a> supports a number of other options, as documented more 
    completely in <a href="polymap.html">POLYMAP</a>.
  
    <a href="pm_sort.html">PM_SORT</a>(...,CUTOFF,...,'population',N) specifies a fixed
    population fit with population N and maximum bandwidth CUTOFF.  N can 
    be a scalar or an L x M matrix.
 
    <a href="pm_sort.html">PM_SORT</a>(...,'verbose') displays the row it is currently working on.
 
    <a href="pm_sort.html">PM_SORT</a>(...,'parallel') parallelizes the computation using PARFOR.
 
    <a href="pm_sort.html">PM_SORT</a>(...'parallel',Nworkers) parallelizes the computation with a
    specified number of workers.
    _________________________________________________________________
  
    See also <a href="polymap.html">POLYMAP</a> and <a href="pm_index.html">PM_INDEX</a>.
 
    '<a href="pm_sort.html">pm_sort</a> --t' runs a test.
 
    Usage: [ds,xs,ys,indexs]=<a href="pm_sort.html">pm_sort</a>(x,y,xo,yo,cutoff);
           [ds,xs,ys,zs,indexs]=<a href="pm_sort.html">pm_sort</a>(x,y,z,xo,yo,cutoff);
           [ds,xs,ys,zs,indexs]=<a href="pm_sort.html">pm_sort</a>(lon,lat,z,lon,lat,cutoff,'sphere');
           [ds,xs,ys,z1s,z2s,...,zNs]=<a href="pm_sort.html">pm_sort</a>(x,y,z1,z2,...,zN,xo,yo,cutoff);
    __________________________________________________________________
    This is part of <a href="jLab.html">JLAB</a> --- type 'help jlab' for more information
    (C) 2022 J.M. Lilly --- type 'help <a href="jlab_license.html">jlab_license</a>' for details
</pre></div><h2><a href="jLab.html">contents</a>  |  <a href="jlab_allhelp.html">allhelp</a>  |  <a href="jlab_index.html">index</a></h2></body></html>